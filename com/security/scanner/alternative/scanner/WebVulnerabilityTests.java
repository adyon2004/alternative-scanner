package com.security.scanner.alternative.scanner;

import com.security.scanner.action.Crawler;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;

import java.io.IOException;
import java.sql.Driver;
import java.util.ArrayList;
import java.util.Collection;
import java.util.HashSet;
import java.util.List;

public class WebVulnerabilityTests {

    public static void main(String[] args) {


        TestWebDriver testWebDriver = new TestWebDriver(new FirefoxDriver());
        //    TestWebDriver testWebDriver = new TestWebDriver(new HtmlUnitDriver());

        Crawler myCrawler;
        String urlToAttack = "http://127.0.0.1:8080/wavsep/RXSS-Detection-Evaluation-POST/index.jsp";
        try {
            myCrawler = new Crawler(urlToAttack);
            myCrawler.crawl();
            HashSet<String> processedUrls = (HashSet<String>) myCrawler.getProcessed();
            for (String processedUrl : processedUrls)
            {
                crawlWebSite(testWebDriver, processedUrl);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }

        testWebDriver.shutdown();

    }

    private static void crawlWebSite(TestWebDriver testWebDriver, String urlToAttack) {


        String attackVector = "<script>alert('CrossSiteScriptingAcademia')</script>";
        testWebDriver.attack(urlToAttack).using(attackVector).run();
        testWebDriver.executionReportFor(attackVector).waitFor();
    }
/*

    String attackVector2 = "<BGSOUND SRC=\"javascript:alert('CrossSiteScriptingAcademia');\">";
    String attackVector3 = "<DIV STYLE=\"background-image: url(javascript:alert('CrossSiteScriptingAcademia'))\">";
    String attackVector4 = "<IMG SRC=\"javascript:alert('CrossSiteScriptingAcademia');\">";
    String attackVector5 = "<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:alert('CrossSiteScriptingAcademia');\">";
*/

}
